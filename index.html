<script>
    async function loadSheetData() {
        const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQhTDvyzxTI5sMY51vJl4haUj29610K3aCkTxG2XhU_ocnD-awkHNbIfTu3BnXYY3Tyz1i2JUylYH78/pub?gid=0&single=true&output=csv"; // 네 CSV 링크

        const response = await fetch(sheetURL);
        const data = await response.text();
        
        const rows = data.split("\n").map(row => row.split(",")); // CSV 데이터 파싱
        let tableHTML = "<table><tr>";

        // 헤더 생성
        rows[0].forEach(header => {
            tableHTML += `<th>${header}</th>`;
        });
        tableHTML += "<th>더보기</th></tr>";

        // 데이터 행 추가
        for (let i = 1; i < rows.length; i++) {
            let rowData = rows[i];

            tableHTML += `<tr>`;
            for (let j = 0; j < rowData.length - 1; j++) {
                tableHTML += `<td>${rowData[j]}</td>`;
            }
            tableHTML += `<td><button onclick="toggleDetails(${i})">상세보기</button></td></tr>`;

            // 상세 정보 추가 (숨겨진 div)
            let detailsData = rowData[rowData.length - 1].split(";"); // 상세 데이터를 `;`로 구분한다고 가정
            let detailsHTML = "<table border='1'>";
            detailsData.forEach(detail => {
                let [key, value] = detail.split(":"); // `키:값` 형태로 저장된 경우
                detailsHTML += `<tr><td>${key}</td><td>${value}</td></tr>`;
            });
            detailsHTML += "</table>";

            tableHTML += `<tr id="details-${i}" class="details"><td colspan="${rowData.length}">
                ${detailsHTML}
            </td></tr>`;
        }

        tableHTML += "</table>";
        document.getElementById("sheetTable").innerHTML = tableHTML;
    }

    function toggleDetails(index) {
        let detailsRow = document.getElementById(`details-${index}`);
        detailsRow.style.display = (detailsRow.style.display === "none" || detailsRow.style.display === "") ? "table-row" : "none";
    }
</script>
